
<%- include('../partials/head', { useBootstrap: true, useGoogleFonts: false }) %>

    <% if (typeof toast !== "undefined" && toast) { %>
        <script>
        window.__TOAST__ = {
            message: "<%- toast.message %>",
            type: "<%= toast.type %>"
        }
        </script>
    <% } %>

  <div id="toast" class="toast"></div>

    <%- include('../partials/logo', { type: 'mini' }) %>


    <section class="min-vh-100 bg-custom">
      <div class="container py-1 h-100">
        <div
          class="row d-flex justify-content-center align-items-center w-100 h-100"
        >
          <div class="col-md-12">
            <div class="bg-dark text-white inner-container" style="border-radius: 1rem; 
                                                   background-color:#24242C;
                                                   box-shadow: 3px 3px 2px #24242C;">
              <div class="mb-md-5 mt-md-4 px-5 py-5">
                <h2 class="fw-bold mb-2 text-uppercase">
                  Welcome  <% if (admin.name) { %>
                     <%= admin.name %> <% }
                      else { %> <%= "Admin" %> <% } %>
                </h2>

                <div class="container-fluid my-4 w-100 w-md-75">
                    <form class="d-flex" method="post" action="/admin/search-user">
                        <input class="form-control me-2"  type="text" placeholder="Search" name="search" aria-label="Search" />
                        <input type="submit"  value="Search" class="btn btn-outline-info">
                    </form>
                </div>
                <div class="table-responsive">
                    <table class="table table-dark table-striped table-hover w-100 dashboard-table">
                        <thead>
                            <tr class="w-100">
                                <th class="sortable" data-key="id">Id <span class="arrow">↕</span></th>
                                <th class="sortable" data-key="name">Name <span class="arrow">↕</span></th>
                                <th>Profile</th>
                                <th>E-mail</th>
                                <th class="sortable" data-key="mobile">Mobile <span class="arrow">↕</span></th>
                                <th>Edit User</th>
                                <th>Delete User</th>
                            </tr>
                        </thead>
                        <tbody id="userTableBody">
                          <% if(users) { %> <% for(let i = 0 ; i < users.length ;
                          i++) { %>
                            <tr>
                                <td><%= i+1 %></td>
                                <td style="font-weight:bold; color:#0dcaf0;"><%= users[i].name %></td>
                                <td><img src=<%= users[i].image%> alt="image" id="table-img"></td>
                                <td><%= users[i].email %></td>
                                <td><%= users[i].mobile %></td>
                                <td>
                                    <a href="/admin/edit-user?id=<%=users[i]._id%>">
                                        <button type="button" class="btn btn-info px-3">
                                            Edit
                                        </button>
                                    </a>
                                </td>
                                <td>
                                    <a class="delete-btn" data-id="<%= users[i]._id %>">
                                        <button type="button" class="btn btn-danger px-3">
                                            Delete
                                        </button>
                                    </a>
                                </td>

                            </tr>
                          <% } } %>
                        </tbody>
                    </table>
                </div>

                <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-baseline gap-3 dashboard-controls">
                    <h2>
                        <a href="/admin/new-user">
                            <button type="button" class="btn btn-info btn-lg px-5 me-2">Add New User</button>
                        </a>
                        <a href="/admin/logout">
                            <button type="button" class="btn btn-outline-light btn-lg px-5" style="border-color:#BA376F;"">Logout</button>
                        </a>
                    </h2>
                    <a href="/admin/home">
                        <button type="button" class="btn btn-outline-light btn-sm px-4" style="border-radius: 20px;">Go to Home</button>
                    </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

<%- include("../partials/footer", {
    scripts: `
        <script src="/public/js/dashboard.js"></script>
        <script src="/public/js/liveUserSearch.js"></script>
        <script src="/public/js/deleteUser.js"></script>
        <script src="/public/js/toast.js"></script>
    `
}) %>
